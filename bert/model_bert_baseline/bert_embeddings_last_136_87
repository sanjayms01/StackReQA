{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"bert_embeddings_last_136_87","provenance":[],"collapsed_sections":[],"toc_visible":true},"kernelspec":{"display_name":"Python 3","name":"python3"},"widgets":{"application/vnd.jupyter.widget-state+json":{"6f0d25ed6aeb478880144bdc7916694a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_7e0448d15d0a4641a56a55f71eef6ef0","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_f0bbc975d10a4355aae2c768acd7b0e5","IPY_MODEL_7c1719f7a8fb4e26b70e92609086ffbb"]}},"7e0448d15d0a4641a56a55f71eef6ef0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f0bbc975d10a4355aae2c768acd7b0e5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0f256103bcbf48189f7718ef5f17f2c5","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":213450,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":213450,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9b2ec6c2a1534587a150b4b847fd2a5e"}},"7c1719f7a8fb4e26b70e92609086ffbb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_c1d3650d56eb492abeb1482aa6f6953d","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 213k/213k [00:00&lt;00:00, 336kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9e401e349345410a8ce01053c45aa2cb"}},"0f256103bcbf48189f7718ef5f17f2c5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"9b2ec6c2a1534587a150b4b847fd2a5e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c1d3650d56eb492abeb1482aa6f6953d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"9e401e349345410a8ce01053c45aa2cb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2e64dd35b4864ad6ad6568eb98c061a1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_b294b9ff3fc0459ab33c1debb5ebfc5a","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_997fd0eccc3343078499639b583b170f","IPY_MODEL_7307b7dd0f3143b481c52404994a9692"]}},"b294b9ff3fc0459ab33c1debb5ebfc5a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"997fd0eccc3343078499639b583b170f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_9d8d6cf1eb4a494ea0c5361988e5ea38","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":29,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":29,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7ee9b717f42c42418f77aacaf10d1516"}},"7307b7dd0f3143b481c52404994a9692":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_d723942e60aa4901b226ebcb5b6148df","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 29.0/29.0 [00:00&lt;00:00, 99.8B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d07d4a9749784a15a066a16dc58c7613"}},"9d8d6cf1eb4a494ea0c5361988e5ea38":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"7ee9b717f42c42418f77aacaf10d1516":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d723942e60aa4901b226ebcb5b6148df":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d07d4a9749784a15a066a16dc58c7613":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d7cbaff396dc4ae1b34c44676beebf37":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e029650142d649c2ac54311e866db30e","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b5832f9457f5436e8c34d2b207462403","IPY_MODEL_d1a2e90d8cb94b28b0f41fb66e2a199a"]}},"e029650142d649c2ac54311e866db30e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b5832f9457f5436e8c34d2b207462403":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_a63f9629503045bd99a811d5d9f0e098","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":435797,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":435797,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_26ee0ec7e5f64de28a372587a02790c9"}},"d1a2e90d8cb94b28b0f41fb66e2a199a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_2304cf8a329a40629beb2d68990d9924","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 436k/436k [00:00&lt;00:00, 3.60MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0a83819ac3104fa38137056a8e5ddd6a"}},"a63f9629503045bd99a811d5d9f0e098":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"26ee0ec7e5f64de28a372587a02790c9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2304cf8a329a40629beb2d68990d9924":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"0a83819ac3104fa38137056a8e5ddd6a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"16d9b204513146e88808d94ae49c65c3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_40bb5b648c154dc4b2ca22ee94820c3b","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_af0a413098054cd0a970faf03c66492e","IPY_MODEL_a55e7a9754f14748b118eb8e4970ad80"]}},"40bb5b648c154dc4b2ca22ee94820c3b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"af0a413098054cd0a970faf03c66492e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e1d038a81d394008bd672c9f4173d2cc","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":433,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":433,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3623076a161e4acbae3c445c681316c9"}},"a55e7a9754f14748b118eb8e4970ad80":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_44fa0a20cb014f4ab94dbf734724ccf7","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 433/433 [00:00&lt;00:00, 716B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7c67e8a128a94e9d82302116e6858dcd"}},"e1d038a81d394008bd672c9f4173d2cc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3623076a161e4acbae3c445c681316c9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"44fa0a20cb014f4ab94dbf734724ccf7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7c67e8a128a94e9d82302116e6858dcd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ef7ae83633274eeb9546e23df5fb65e1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_841c51e061fa4c44a9793915cc5c9712","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_89a7036aa75e4e30a88e077bba655023","IPY_MODEL_fa58fe50fe2840eab9ad770ddc12e2a7"]}},"841c51e061fa4c44a9793915cc5c9712":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"89a7036aa75e4e30a88e077bba655023":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_34341afcc21e4333bb38e1812a971f99","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":526681800,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":526681800,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_44f333c228b44cbbaaa82d138abe93e8"}},"fa58fe50fe2840eab9ad770ddc12e2a7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e9c8b8b620ba4aae90ce9130989ee677","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 527M/527M [00:12&lt;00:00, 43.8MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_bfcb16d594ac45668e33b7cdd4ac60fc"}},"34341afcc21e4333bb38e1812a971f99":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"44f333c228b44cbbaaa82d138abe93e8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e9c8b8b620ba4aae90ce9130989ee677":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"bfcb16d594ac45668e33b7cdd4ac60fc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6ur3ixnlycEo","executionInfo":{"status":"ok","timestamp":1617153503075,"user_tz":300,"elapsed":18207,"user":{"displayName":"John Lee","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi0ElGxTD4WfRf4lVeXeZpRtAdemu75222MUOG8=s64","userId":"01035905861574025218"}},"outputId":"b9f3c2d5-60ff-42ab-c36e-8a31a57ede98"},"source":["from google.colab import drive\n","drive.mount('/content/drive')"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Mounted at /content/drive\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3fxOFlSneTau","executionInfo":{"status":"ok","timestamp":1617153512174,"user_tz":300,"elapsed":9085,"user":{"displayName":"John Lee","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi0ElGxTD4WfRf4lVeXeZpRtAdemu75222MUOG8=s64","userId":"01035905861574025218"}},"outputId":"a9f70289-449c-4cdf-9b3d-9e1d4d2bc0b4"},"source":["pip install transformers"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Collecting transformers\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/ed/d5/f4157a376b8a79489a76ce6cfe147f4f3be1e029b7144fa7b8432e8acb26/transformers-4.4.2-py3-none-any.whl (2.0MB)\n","\u001b[K     |████████████████████████████████| 2.0MB 5.7MB/s \n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from transformers) (20.9)\n","Collecting tokenizers<0.11,>=0.10.1\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/71/23/2ddc317b2121117bf34dd00f5b0de194158f2a44ee2bf5e47c7166878a97/tokenizers-0.10.1-cp37-cp37m-manylinux2010_x86_64.whl (3.2MB)\n","\u001b[K     |████████████████████████████████| 3.2MB 45.4MB/s \n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.41.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.19.5)\n","Requirement already satisfied: importlib-metadata; python_version < \"3.8\" in /usr/local/lib/python3.7/dist-packages (from transformers) (3.8.1)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Collecting sacremoses\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/7d/34/09d19aff26edcc8eb2a01bed8e98f13a1537005d31e95233fd48216eed10/sacremoses-0.0.43.tar.gz (883kB)\n","\u001b[K     |████████████████████████████████| 890kB 42.4MB/s \n","\u001b[?25hRequirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.0.12)\n","Requirement already satisfied: pyparsing>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->transformers) (2.4.7)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata; python_version < \"3.8\"->transformers) (3.4.1)\n","Requirement already satisfied: typing-extensions>=3.6.4; python_version < \"3.8\" in /usr/local/lib/python3.7/dist-packages (from importlib-metadata; python_version < \"3.8\"->transformers) (3.7.4.3)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2020.12.5)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.15.0)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (7.1.2)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.0.1)\n","Building wheels for collected packages: sacremoses\n","  Building wheel for sacremoses (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for sacremoses: filename=sacremoses-0.0.43-cp37-none-any.whl size=893262 sha256=d0f9336121a838c5c0b42b0992b3e89b0abde4296d4354d6fa01be5b52f66c88\n","  Stored in directory: /root/.cache/pip/wheels/29/3c/fd/7ce5c3f0666dab31a50123635e6fb5e19ceb42ce38d4e58f45\n","Successfully built sacremoses\n","Installing collected packages: tokenizers, sacremoses, transformers\n","Successfully installed sacremoses-0.0.43 tokenizers-0.10.1 transformers-4.4.2\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"6VOIuvjGjlw3"},"source":["import sys\n","# sys.path.remove('/content/drive/MyDrive/Colab Notebooks/W266 Final Project/master/helper_functions')\n","sys.path.append('/content/drive/MyDrive/Colab Notebooks/W266 Final Project/master/helper_functions')"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"LVhGRln-juWi","executionInfo":{"status":"ok","timestamp":1617153717761,"user_tz":300,"elapsed":294,"user":{"displayName":"John Lee","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi0ElGxTD4WfRf4lVeXeZpRtAdemu75222MUOG8=s64","userId":"01035905861574025218"}},"outputId":"f6dd3cbd-7053-488d-d1f0-b95b0953d1a4"},"source":["for p in sys.path:\n","  print(p)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["\n","/content\n","/env/python\n","/usr/lib/python37.zip\n","/usr/lib/python3.7\n","/usr/lib/python3.7/lib-dynload\n","/usr/local/lib/python3.7/dist-packages\n","/usr/lib/python3/dist-packages\n","/usr/local/lib/python3.7/dist-packages/IPython/extensions\n","/root/.ipython\n","/content/drive/MyDrive/Colab Notebooks/W266 Final Project/master/helper_functions\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"RUC4qc_yj9U8"},"source":["# Imports"]},{"cell_type":"code","metadata":{"id":"jR7iTVGVj-9x"},"source":["import pandas as pd\n","import numpy as np\n","import tensorflow as tf\n","import tensorflow_hub as hub\n","import math\n","import random\n","import pickle\n","import time\n","\n","from numpy.linalg import norm\n","from scipy.stats import rankdata\n","from transformers import BertTokenizer, TFBertModel\n","\n","from tensorflow.keras import layers\n","from tensorflow.keras.layers import Dense, Flatten\n","\n","import parse\n","import bert_funcs as bf\n","import evaluation"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":487},"id":"whzGGkqQkBsS","executionInfo":{"status":"ok","timestamp":1617153730024,"user_tz":300,"elapsed":11266,"user":{"displayName":"John Lee","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi0ElGxTD4WfRf4lVeXeZpRtAdemu75222MUOG8=s64","userId":"01035905861574025218"}},"outputId":"a6d5032b-bdf5-4c61-b77d-7650a555d331"},"source":["df = pd.read_csv(r'/content/drive/MyDrive/Colab Notebooks/W266 Final Project/data/raw_data_preprocessed.csv')\n","df.head(5)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>question_id</th>\n","      <th>question_title_raw</th>\n","      <th>question_body_raw</th>\n","      <th>question_body</th>\n","      <th>question_body_text</th>\n","      <th>question_body_code</th>\n","      <th>question_title_body_raw</th>\n","      <th>question_title_body</th>\n","      <th>question_title_body_text</th>\n","      <th>question_title_body_code</th>\n","      <th>answer_id</th>\n","      <th>answer_body_raw</th>\n","      <th>answer_body</th>\n","      <th>answer_text</th>\n","      <th>answer_code</th>\n","      <th>answer_count</th>\n","      <th>view_count</th>\n","      <th>answer_score</th>\n","      <th>is_accepted_answer</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>55661532</td>\n","      <td>When I run my socket program, there get: `impo...</td>\n","      <td>&lt;p&gt;I write a socket server programmer:&lt;/p&gt;\\n\\n...</td>\n","      <td>I write a socket server programmer:\\n#-*- codi...</td>\n","      <td>I write a socket server programmer:\\n\\nwhen I ...</td>\n","      <td>#-*- coding:utf-8 -*-\\n# Author:sele\\n\\nimport...</td>\n","      <td>When I run my socket program, there get: `impo...</td>\n","      <td>When I run my socket program, there get: `impo...</td>\n","      <td>When I run my socket program, there get: `impo...</td>\n","      <td>#-*- coding:utf-8 -*-\\n# Author:sele\\n\\nimport...</td>\n","      <td>55661630</td>\n","      <td>&lt;p&gt;The answer to your new question is that you...</td>\n","      <td>The answer to your new question is that you ca...</td>\n","      <td>The answer to your new question is that you ca...</td>\n","      <td>socket.socket(socket.AF_INET, socket.SOCK_STRE...</td>\n","      <td>2</td>\n","      <td>1816</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>55661626</td>\n","      <td>with socket.socket(socket.AF_INET, socket.SOCK...</td>\n","      <td>&lt;p&gt;I have a socket server program:&lt;/p&gt;\\n\\n&lt;pre...</td>\n","      <td>I have a socket server program:\\n#!/usr/bin/en...</td>\n","      <td>I have a socket server program:\\n\\nwhen I run ...</td>\n","      <td>#!/usr/bin/env python\\n#-*- coding:utf-8 -*-\\n...</td>\n","      <td>with socket.socket(socket.AF_INET, socket.SOCK...</td>\n","      <td>with socket.socket(socket.AF_INET, socket.SOCK...</td>\n","      <td>with socket.socket(socket.AF_INET, socket.SOCK...</td>\n","      <td>#!/usr/bin/env python\\n#-*- coding:utf-8 -*-\\n...</td>\n","      <td>55661660</td>\n","      <td>&lt;p&gt;You can't use &lt;code&gt;socket.socket(socket.AF...</td>\n","      <td>You can't use socket.socket(socket.AF_INET, so...</td>\n","      <td>You can't use  with .  So that a  statement ca...</td>\n","      <td>socket.socket(socket.AF_INET, socket.SOCK_STRE...</td>\n","      <td>2</td>\n","      <td>2521</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>55661929</td>\n","      <td>How to display 5 numbers per line from a list?</td>\n","      <td>&lt;p&gt;How to display 5 numbers per line from a li...</td>\n","      <td>How to display 5 numbers per line from a list?...</td>\n","      <td>How to display 5 numbers per line from a list?...</td>\n","      <td>lx = [1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,...</td>\n","      <td>How to display 5 numbers per line from a list?...</td>\n","      <td>How to display 5 numbers per line from a list?...</td>\n","      <td>How to display 5 numbers per line from a list?...</td>\n","      <td>lx = [1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,...</td>\n","      <td>55662134</td>\n","      <td>&lt;p&gt;There can be different approaches to the pr...</td>\n","      <td>There can be different approaches to the probl...</td>\n","      <td>There can be different approaches to the probl...</td>\n","      <td>x=[]  #your given list\\nfor t in range(len(x))...</td>\n","      <td>4</td>\n","      <td>125</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>55662778</td>\n","      <td>create list with spectial type - Spyder error ...</td>\n","      <td>&lt;p&gt;I want to print &lt;code&gt;&amp;gt;&lt;/code&gt; in the sc...</td>\n","      <td>I want to print &gt; in the script 0 to test the ...</td>\n","      <td>I want to print  in the script 0 to test the c...</td>\n","      <td>&gt;script[0][4][2]name 'script' is not defined\\n...</td>\n","      <td>create list with spectial type - Spyder error ...</td>\n","      <td>create list with spectial type - Spyder error ...</td>\n","      <td>create list with spectial type - Spyder error ...</td>\n","      <td>&gt;script[0][4][2]name 'script' is not defined\\n...</td>\n","      <td>55662821</td>\n","      <td>&lt;p&gt;Define list as &lt;code&gt;[]&lt;/code&gt; and use &lt;cod...</td>\n","      <td>Define list as [] and use append to add elemen...</td>\n","      <td>Define list as  and use  to add elements to li...</td>\n","      <td>[]appendscript = []\\n\\nscript.append(['A','A',...</td>\n","      <td>2</td>\n","      <td>24</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>55662778</td>\n","      <td>create list with spectial type - Spyder error ...</td>\n","      <td>&lt;p&gt;I want to print &lt;code&gt;&amp;gt;&lt;/code&gt; in the sc...</td>\n","      <td>I want to print &gt; in the script 0 to test the ...</td>\n","      <td>I want to print  in the script 0 to test the c...</td>\n","      <td>&gt;script[0][4][2]name 'script' is not defined\\n...</td>\n","      <td>create list with spectial type - Spyder error ...</td>\n","      <td>create list with spectial type - Spyder error ...</td>\n","      <td>create list with spectial type - Spyder error ...</td>\n","      <td>&gt;script[0][4][2]name 'script' is not defined\\n...</td>\n","      <td>55662828</td>\n","      <td>&lt;p&gt;I modified your code slightly:&lt;/p&gt;\\n\\n&lt;pre&gt;...</td>\n","      <td>I modified your code slightly:\\nscript = [['A'...</td>\n","      <td>I modified your code slightly:\\n\\nand it works...</td>\n","      <td>script = [['A','A',['A'],['A'],['A','5','&gt;'],'...</td>\n","      <td>2</td>\n","      <td>24</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   question_id  ... is_accepted_answer\n","0     55661532  ...                  0\n","1     55661626  ...                  1\n","2     55661929  ...                  0\n","3     55662778  ...                  1\n","4     55662778  ...                  0\n","\n","[5 rows x 19 columns]"]},"metadata":{"tags":[]},"execution_count":6}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"2T2rDfnfkW4S","executionInfo":{"status":"ok","timestamp":1617153730027,"user_tz":300,"elapsed":10621,"user":{"displayName":"John Lee","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi0ElGxTD4WfRf4lVeXeZpRtAdemu75222MUOG8=s64","userId":"01035905861574025218"}},"outputId":"91fe3c27-6547-4815-a26b-37f2d83eebf3"},"source":["df_bert = df[['question_id', 'question_title_body', 'answer_id', 'answer_body', 'is_accepted_answer']]\n","df_bert.head(5)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>question_id</th>\n","      <th>question_title_body</th>\n","      <th>answer_id</th>\n","      <th>answer_body</th>\n","      <th>is_accepted_answer</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>55661532</td>\n","      <td>When I run my socket program, there get: `impo...</td>\n","      <td>55661630</td>\n","      <td>The answer to your new question is that you ca...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>55661626</td>\n","      <td>with socket.socket(socket.AF_INET, socket.SOCK...</td>\n","      <td>55661660</td>\n","      <td>You can't use socket.socket(socket.AF_INET, so...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>55661929</td>\n","      <td>How to display 5 numbers per line from a list?...</td>\n","      <td>55662134</td>\n","      <td>There can be different approaches to the probl...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>55662778</td>\n","      <td>create list with spectial type - Spyder error ...</td>\n","      <td>55662821</td>\n","      <td>Define list as [] and use append to add elemen...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>55662778</td>\n","      <td>create list with spectial type - Spyder error ...</td>\n","      <td>55662828</td>\n","      <td>I modified your code slightly:\\nscript = [['A'...</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   question_id  ... is_accepted_answer\n","0     55661532  ...                  0\n","1     55661626  ...                  1\n","2     55661929  ...                  0\n","3     55662778  ...                  1\n","4     55662778  ...                  0\n","\n","[5 rows x 5 columns]"]},"metadata":{"tags":[]},"execution_count":7}]},{"cell_type":"markdown","metadata":{"id":"xGKDmwz9k1hb"},"source":["# Preprocessing"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":379,"referenced_widgets":["6f0d25ed6aeb478880144bdc7916694a","7e0448d15d0a4641a56a55f71eef6ef0","f0bbc975d10a4355aae2c768acd7b0e5","7c1719f7a8fb4e26b70e92609086ffbb","0f256103bcbf48189f7718ef5f17f2c5","9b2ec6c2a1534587a150b4b847fd2a5e","c1d3650d56eb492abeb1482aa6f6953d","9e401e349345410a8ce01053c45aa2cb","2e64dd35b4864ad6ad6568eb98c061a1","b294b9ff3fc0459ab33c1debb5ebfc5a","997fd0eccc3343078499639b583b170f","7307b7dd0f3143b481c52404994a9692","9d8d6cf1eb4a494ea0c5361988e5ea38","7ee9b717f42c42418f77aacaf10d1516","d723942e60aa4901b226ebcb5b6148df","d07d4a9749784a15a066a16dc58c7613","d7cbaff396dc4ae1b34c44676beebf37","e029650142d649c2ac54311e866db30e","b5832f9457f5436e8c34d2b207462403","d1a2e90d8cb94b28b0f41fb66e2a199a","a63f9629503045bd99a811d5d9f0e098","26ee0ec7e5f64de28a372587a02790c9","2304cf8a329a40629beb2d68990d9924","0a83819ac3104fa38137056a8e5ddd6a","16d9b204513146e88808d94ae49c65c3","40bb5b648c154dc4b2ca22ee94820c3b","af0a413098054cd0a970faf03c66492e","a55e7a9754f14748b118eb8e4970ad80","e1d038a81d394008bd672c9f4173d2cc","3623076a161e4acbae3c445c681316c9","44fa0a20cb014f4ab94dbf734724ccf7","7c67e8a128a94e9d82302116e6858dcd","ef7ae83633274eeb9546e23df5fb65e1","841c51e061fa4c44a9793915cc5c9712","89a7036aa75e4e30a88e077bba655023","fa58fe50fe2840eab9ad770ddc12e2a7","34341afcc21e4333bb38e1812a971f99","44f333c228b44cbbaaa82d138abe93e8","e9c8b8b620ba4aae90ce9130989ee677","bfcb16d594ac45668e33b7cdd4ac60fc"]},"id":"DQ3wAazOkhy3","executionInfo":{"status":"ok","timestamp":1617153749451,"user_tz":300,"elapsed":28998,"user":{"displayName":"John Lee","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi0ElGxTD4WfRf4lVeXeZpRtAdemu75222MUOG8=s64","userId":"01035905861574025218"}},"outputId":"d085443d-0979-4618-e009-420fc8134cd1"},"source":["tokenizer = BertTokenizer.from_pretrained('bert-base-cased')\n","model = TFBertModel.from_pretrained('bert-base-cased')"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"6f0d25ed6aeb478880144bdc7916694a","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=213450.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"2e64dd35b4864ad6ad6568eb98c061a1","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=29.0, style=ProgressStyle(description_w…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d7cbaff396dc4ae1b34c44676beebf37","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=435797.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"16d9b204513146e88808d94ae49c65c3","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=433.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ef7ae83633274eeb9546e23df5fb65e1","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=526681800.0, style=ProgressStyle(descri…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"stream","text":["Some layers from the model checkpoint at bert-base-cased were not used when initializing TFBertModel: ['mlm___cls', 'nsp___cls']\n","- This IS expected if you are initializing TFBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing TFBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","All the layers of TFBertModel were initialized from the model checkpoint at bert-base-cased.\n","If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.\n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"HMA6bcUz4c2S"},"source":["### Create Tokens Dictionary"]},{"cell_type":"code","metadata":{"id":"PkbIRe6Rk5cD"},"source":["tokens_dict = {}"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"rcFsVx3flRa1"},"source":["# One dict for storing every question and answer ID associated with (token IDs, mask IDs, and segment IDs)\n","max_length_question=136 #EDA shows that average length is 135.7\n","for question_id in df_bert['question_id'].unique():\n","  tokens, masks, segments = bf.bert_encode_content(df_bert.loc[df_bert['question_id'] == question_id].question_title_body.values[0], tokenizer, max_length_question)\n","  tokens_dict[question_id] = (tokens, masks, segments)\n","\n","max_length_answer=87 #EDA shows that average length is 86.1\n","for answer_id in df_bert['answer_id']:\n","  tokens, masks, segments = bf.bert_encode_content(df_bert.loc[df_bert['answer_id'] == answer_id].answer_body.values[0], tokenizer, max_length_answer)\n","  tokens_dict[answer_id] = (tokens, masks, segments)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"_sIe5wntl7hw"},"source":["# Save tokens dictionary to file\n","tokens_dict_to_file = open('/content/drive/MyDrive/Colab Notebooks/W266 Final Project/data/embeddings/bert_batches_136_87/bert_tokens_136_87.pickle', 'wb')\n","pickle.dump(tokens_dict, tokens_dict_to_file)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"3zcOwXyGmJSc"},"source":["# Load tokens dictionary from file\n","tokens_from_file = open('/content/drive/MyDrive/Colab Notebooks/W266 Final Project/data/embeddings/bert_batches_136_87/bert_tokens_136_87.pickle', 'rb')\n","bert_tokens_dict = pickle.load(tokens_from_file)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"7Pr63PzC4gu_"},"source":["### REFER TO BATCHES FOR CREATING EMBEDDINGS"]}]}